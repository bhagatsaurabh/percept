!function(t,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define("Percept",[],o):"object"==typeof exports?exports.Percept=o():t.Percept=o()}(self,function(){return(()=>{"use strict";var s={871:(t,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Constant=void 0,(o=o.Constant||(o.Constant={}))[o.TAU=Math.PI/180]="TAU"},426:(t,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Dimension=void 0;var e=(s.prototype.max=function(){return Math.max(this.width,this.height)},s);function s(t,o){this.width=t,this.height=o}o.Dimension=e},726:function(t,o,e){var s=this&&this.__createBinding||(Object.create?function(t,o,e,s){void 0===s&&(s=e),Object.defineProperty(t,s,{enumerable:!0,get:function(){return o[e]}})}:function(t,o,e,s){t[s=void 0===s?e:s]=o[e]}),i=this&&this.__exportStar||function(t,o){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(o,e)||s(o,t,e)};Object.defineProperty(o,"__esModule",{value:!0}),i(e(871),o),i(e(426),o),i(e(863),o),i(e(860),o),i(e(316),o)},863:function(t,o){var h=this&&this.__spreadArrays||function(){for(var t=0,o=0,e=arguments.length;o<e;o++)t+=arguments[o].length;for(var s=Array(t),i=0,o=0;o<e;o++)for(var n=arguments[o],r=0,h=n.length;r<h;r++,i++)s[i]=n[r];return s};Object.defineProperty(o,"__esModule",{value:!0}),o.Matrix=void 0;var e=(r.prototype.multiply=function(o){var t;if(o instanceof r){t=h(Array(this.value.length)).map(function(t){return Array(o.value[0].length)});for(var e=0;e<this.value.length;e++)for(var s=0;s<o.value[0].length;s++){for(var i=0,n=0;n<this.value[0].length;n++)i+=this.value[e][n]*o.value[n][s];t[e][s]=i}}else{t=h(Array(this.value.length)).map(function(t){return Array(o[0].length)});for(e=0;e<this.value.length;e++)for(s=0;s<o[0].length;s++){for(i=0,n=0;n<this.value[0].length;n++)i+=this.value[e][n]*o[n][s];t[e][s]=i}}return new r(t)},r.prototype.multiplyInPlace=function(o){var t;if(o instanceof r){t=h(Array(this.value.length)).map(function(t){return Array(o.value[0].length)});for(var e=0;e<this.value.length;e++)for(var s=0;s<o.value[0].length;s++){for(var i=0,n=0;n<this.value[0].length;n++)i+=this.value[e][n]*o.value[n][s];t[e][s]=i}}else{t=h(Array(this.value.length)).map(function(t){return Array(o[0].length)});for(e=0;e<this.value.length;e++)for(s=0;s<o[0].length;s++){for(i=0,n=0;n<this.value[0].length;n++)i+=this.value[e][n]*o[n][s];t[e][s]=i}}return this.value=t,this},r.prototype.clone=function(){return new r([[this.value[0][0],this.value[0][1],this.value[0][2]],[this.value[1][0],this.value[1][1],this.value[1][2]],[this.value[2][0],this.value[2][1],this.value[2][2]]])},r.prototype.getRotation=function(){return Math.atan2(this.value[0][1],this.value[0][0])*(180/Math.PI)},r.Identity=function(){return new r([[1,0,0],[0,1,0],[0,0,1]])},r.Zero=function(){return new r([[0,0,0],[0,0,0],[0,0,0]])},r.Multiply=function(t,o){for(var e=h(Array(t.length)).map(function(t){return Array(o[0].length)}),s=0;s<t.length;s++)for(var i=0;i<o[0].length;i++){for(var n=0,r=0;r<t[0].length;r++)n+=t[s][r]*o[r][i];e[s][i]=n}return e},r);function r(t){this.value=t}o.Matrix=e},860:function(t,o,e){var r=this&&this.__spreadArrays||function(){for(var t=0,o=0,e=arguments.length;o<e;o++)t+=arguments[o].length;for(var s=Array(t),i=0,o=0;o<e;o++)for(var n=arguments[o],r=0,h=n.length;r<h;r++,i++)s[i]=n[r];return s};Object.defineProperty(o,"__esModule",{value:!0}),o.Transform=void 0;var i=e(726),h=e(726),s=e(726),e=(Object.defineProperty(n.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent&&this._parent.childs.indexOf(this)&&this._parent.childs.splice(this._parent.childs.indexOf(this),1),t&&t.childs.push(this),this._parent=t,this.parent&&this.parent.childs.sort(function(t,o){return t.node.order-o.node.order})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"absolutePosition",{get:function(){return s.Vector2.Zero().transform(this.worldTransform)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t%360},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localRotation",{get:function(){return this._localRotation},set:function(t){this._localRotation=t%360},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t},enumerable:!1,configurable:!0}),n.prototype.relativeControlPoints=function(t){var o=this,e=[];return t.forEach(function(t){e.push(t.subtract(o.position))}),e},n.prototype.updateWorldTransform=function(t){var o=this;this.localTrasform.value=[[1,0,0],[0,1,0],[this.position.x,this.position.y,1]],"#Root"!=this.parent.node.id&&(s=Math.cos(this.rotation*i.Constant.TAU),e=Math.sin(this.rotation*i.Constant.TAU),this.localTrasform=new h.Matrix([[1,0,0],[0,1,0],[this.position.x,this.position.y,1]]).multiply([[s,e,0],[-e,s,0],[0,0,1]]).multiply([[1,0,0],[0,1,0],[-this.position.x,-this.position.y,1]]).multiply(this.localTrasform));var e=Math.cos(this.localRotation*i.Constant.TAU),s=Math.sin(this.localRotation*i.Constant.TAU);this.localTrasform=new h.Matrix([[e,s,0],[-s,e,0],[0,0,1]]).multiply(this.localTrasform),this.localTrasform=new h.Matrix([[this.scale.x,0,0],[0,this.scale.y,0],[0,0,1]]).multiply(this.localTrasform),this.worldTransform=t?this.localTrasform.multiply(t):this.localTrasform.clone(),this.childs.forEach(function(t){t.updateWorldTransform(o.worldTransform)}),this.applyTransform()},n.prototype.applyTransform=function(){var e=this;this.refControlPoints.forEach(function(t,o){e.controlPoints[o]=t.transform(e.worldTransform)})},n);function n(t,o,e,s,i,n){this._position=t,this._localRotation=o,this._rotation=e,this._scale=s,this.node=n,this._parent=null,this.childs=[],this.localTrasform=h.Matrix.Identity(),this.worldTransform=h.Matrix.Identity(),this.refControlPoints=this.relativeControlPoints(i),this.controlPoints=r(i)}o.Transform=e},316:(t,o,e)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Vector2=void 0;var i=e(235),s=e(726),n=e(726),e=(r.prototype.toString=function(){return"["+this.x.toFixed(3)+", "+this.y.toFixed(3)+"]"},r.prototype.add=function(t,o){return t instanceof r?new r(this.x+t.x,this.y+t.y):new r(this.x+t,void 0===o?this.y+t:this.y+o)},r.prototype.addInPlace=function(t,o){return t instanceof r?(this.x+=t.x,this.y+=t.y):o?(this.x+=t,this.y+=o):(this.x+=t,this.y+=t),this},r.prototype.multiply=function(t,o){return t instanceof r?new r(this.x*t.x,this.y*t.y):new r(this.x*t,this.y*o)},r.prototype.multiplyInPlace=function(t,o){return t instanceof r?(this.x*=t.x,this.y*=t.y):o?(this.x*=t,this.y*=o):(this.x*=t,this.y*=t),this},r.prototype.subtract=function(t,o){return t instanceof r?new r(this.x-t.x,this.y-t.y):new r(this.x-t,this.y-o)},r.prototype.subtractInPlace=function(t,o){t instanceof r?(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=o)},r.prototype.rotate=function(t,o){o*=s.Constant.TAU;var e=Math.cos(o),o=Math.sin(o);return new r(e*(this.x-t.x)-o*(this.y-t.y)+t.x,o*(this.x-t.x)+e*(this.y-t.y)+t.y)},r.prototype.rotateInPlace=function(t,o){o*=s.Constant.TAU;var e=Math.cos(o),o=Math.sin(o);return this.tmpX=e*(this.x-t.x)-o*(this.y-t.y)+t.x,this.tmpY=o*(this.x-t.x)+e*(this.y-t.y)+t.y,this.x=this.tmpX,this.y=this.tmpY,this},r.prototype.max=function(){return Math.max(this.x,this.y)},r.prototype.transform=function(t){t=n.Matrix.Multiply([[this.x,this.y,1]],t.value);return new r(t[0][0],t[0][1])},r.prototype.transformInPlace=function(t){t=n.Matrix.Multiply([[this.x,this.y,1]],t.value);this.x=t[0][0],this.y=t[0][1]},r.Midpoint=function(t,o){return new r((t.x+o.x)/2,(t.y+o.y)/2)},r.Distance=function(t,o){return Math.sqrt(Math.pow(o.x-t.x,2)+Math.pow(o.y-t.y,2))},r.Zero=function(){return new r(0,0)},r.One=function(){return new r(1,1)},r.Bounds=function(t){var o=new r(Number.MAX_VALUE,Number.MAX_VALUE),e=new r(Number.MIN_VALUE,Number.MIN_VALUE);return t.forEach(function(t){t.x<o.x&&(o.x=t.x),t.y<o.y&&(o.y=t.y),t.x>e.x&&(e.x=t.x),t.y>e.y&&(e.y=t.y)}),[o,e]},r.Average=function(t){var o=0,e=0;return t.forEach(function(t){o+=t.x,e+=t.y}),new r(o/t.length,e/t.length)},r.Random=function(t,o,e,s){return t instanceof i.Canvas?new r(Math.random()*t.width,Math.random()*t.height):new r(Math.random()*(o-t)+t,Math.random()*(s-e)+e)},r.Lerp=function(t,o,e){return new r(t.x+(o.x-t.x)*e,t.y+(o.y-t.y)*e)},r.prototype.clone=function(){return new r(this.x,this.y)},r);function r(t,o){this.x=t,this.y=o}o.Vector2=e},985:function(t,o,e){var s,i=this&&this.__extends||(s=function(t,o){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}s(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(o,"__esModule",{value:!0}),o.Ellipse=void 0;var n,r=e(726),e=e(697),i=(n=e.Node,i(h,n),h.prototype._render=function(){this.props&&(this.props.outlineColor&&(this.context.strokeStyle="string"==typeof this.props.outlineColor?this.props.outlineColor:this.props.outlineColor.create(this.context)),this.props.fillColor&&(this.context.fillStyle="string"==typeof this.props.fillColor?this.props.fillColor:this.props.fillColor.create(this.context)),this.props.outlineWidth&&(this.context.lineWidth=this.props.outlineWidth),this.props.outlineDashSegments&&this.context.setLineDash(this.props.outlineDashSegments),this.props.shadowColor&&(this.context.shadowColor=this.props.shadowColor),this.props.shadowBlur&&(this.context.shadowBlur=this.props.shadowBlur),this.props.shadowOffset&&(this.props.staticShadow?(this.context.shadowOffsetX=this.props.shadowOffset.x,this.context.shadowOffsetY=this.props.shadowOffset.y):(t=this.props.shadowOffset.transform(this.transform.worldTransform).subtract(this.absolutePosition),this.context.shadowOffsetX=t.x,this.context.shadowOffsetY=t.y)));var t=this.absolutePosition;this.context.beginPath(),this.minor==this.major?this.context.arc(t.x,t.y,this.minor,0,2*Math.PI):this.context.ellipse(t.x,t.y,this.major,this.minor,Math.atan2(this.transform.controlPoints[1].y-t.y,this.transform.controlPoints[1].x-t.x),0,2*Math.PI),this.props.fill&&this.context.fill(),!this.props.outline&&this.props.fill||this.context.stroke()},h.prototype._offRender=function(){this.props.outlineWidth&&(this.offContext.lineWidth=this.props.outlineWidth),this.offContext.strokeStyle=this.hitColor,this.offContext.fillStyle=this.hitColor;var t=this.absolutePosition;this.offContext.beginPath(),this.minor==this.major?this.offContext.arc(t.x,t.y,this.minor,0,2*Math.PI):this.offContext.ellipse(t.x,t.y,this.major,this.minor,Math.atan2(this.transform.controlPoints[1].y-t.y,this.transform.controlPoints[1].x-t.x),0,2*Math.PI),this.props.fill&&this.offContext.fill(),!this.props.outline&&this.props.fill||this.offContext.stroke()},h.prototype.getDimension=function(){return new r.Vector2(r.Vector2.Distance(this.transform.controlPoints[1],this.transform.controlPoints[3]),r.Vector2.Distance(this.transform.controlPoints[0],this.transform.controlPoints[2]))},h);function h(t,o,e,s,i){o=n.call(this,t,o,[o.subtract(0,e),o.add(s,0),o.add(0,e),o.subtract(s,0)])||this;return o.minor=e,o.major=s,(o.props=i)||(o.props={}),o.props.outlineColor&&"string"!=typeof o.props.outlineColor&&(o.props.outlineColor.node=o),o.props.fillColor&&"string"!=typeof o.props.fillColor&&(o.props.fillColor.node=o),o}o.Ellipse=i},397:function(t,o,e){var s,i=this&&this.__extends||(s=function(t,o){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}s(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(o,"__esModule",{value:!0}),o.Empty=void 0;var n,r=e(726),e=e(697),i=(n=e.Node,i(h,n),h.prototype._render=function(){},h.prototype._offRender=function(){},h.prototype.getDimension=function(){return r.Vector2.Zero()},h);function h(t,o){return n.call(this,t,o,[])||this}o.Empty=i},700:function(t,o,e){var s,i=this&&this.__extends||(s=function(t,o){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}s(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(o,"__esModule",{value:!0}),o.Image=void 0;var r,n=e(726),e=e(697),i=(r=e.Node,i(h,r),h.prototype._render=function(){this.props&&(this.props.shadowColor&&(this.context.shadowColor=this.props.shadowColor),this.props.shadowBlur&&(this.context.shadowBlur=this.props.shadowBlur),this.props.shadowOffset&&(this.props.staticShadow?(this.context.shadowOffsetX=this.props.shadowOffset.x,this.context.shadowOffsetY=this.props.shadowOffset.y):(t=this.props.shadowOffset.transform(this.transform.worldTransform).subtract(this.absolutePosition),this.context.shadowOffsetX=t.x,this.context.shadowOffsetY=t.y))),this.context.translate(this.absolutePosition.x,this.absolutePosition.y),this.context.rotate(this.transform.worldTransform.getRotation()*(Math.PI/180)),this.context.translate(-this.absolutePosition.x,-this.absolutePosition.y);var t=this.absolutePosition.subtract(this.width*this.transform.scale.x/2,this.height*this.transform.scale.y/2);this.context.drawImage(this._source,t.x,t.y,this.width*this.transform.scale.x,this.height*this.transform.scale.y)},h.prototype._offRender=function(){this.offContext.fillStyle=this.hitColor,this.offContext.translate(this.absolutePosition.x,this.absolutePosition.y),this.offContext.rotate(this.transform.worldTransform.getRotation()*(Math.PI/180)),this.offContext.translate(-this.absolutePosition.x,-this.absolutePosition.y);var t=this.absolutePosition.subtract(this.width*this.transform.scale.x/2,this.height*this.transform.scale.y/2);this.offContext.fillRect(t.x,t.y,this.width*this.transform.scale.x,this.height*this.transform.scale.y)},h.prototype.getDimension=function(){return new n.Vector2(this.width,this.height)},h);function h(t,o,e,s,i,n){o=r.call(this,t,o,[])||this;return o.width=s,o.height=i,(o.props=n)||(o.props={}),"string"==typeof e?(o._source=new window.Image,o._source.src=e):o._source=e,o._source.crossOrigin="Anonymous",o}o.Image=i},605:function(t,o,e){var s,i=this&&this.__extends||(s=function(t,o){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}s(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(o,"__esModule",{value:!0}),o.Line=void 0;var n,r=e(726),h=e(697),i=(n=h.Node,i(a,n),Object.defineProperty(a.prototype,"from",{get:function(){return this._from instanceof h.Node?this._from.absolutePosition:this.transform.controlPoints[0]},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"to",{get:function(){return this._to instanceof h.Node?this._to.absolutePosition:this.transform.controlPoints[1]},enumerable:!1,configurable:!0}),a.prototype._render=function(){var t;this.props&&(this.props.color&&(this.context.strokeStyle="string"==typeof this.props.color?this.props.color:this.props.color.create(this.context)),this.props.lineWidth&&(this.context.lineWidth=this.props.lineWidth),this.props.lineCap&&(this.context.lineCap=this.props.lineCap),this.props.lineDashSegments&&this.context.setLineDash(this.props.lineDashSegments),this.props.shadowColor&&(this.context.shadowColor=this.props.shadowColor),this.props.shadowBlur&&(this.context.shadowBlur=this.props.shadowBlur),this.props.shadowOffset&&(this.props.staticShadow?(this.context.shadowOffsetX=this.props.shadowOffset.x,this.context.shadowOffsetY=this.props.shadowOffset.y):(t=this.props.shadowOffset.transform(this.transform.worldTransform).subtract(this.absolutePosition),this.context.shadowOffsetX=t.x,this.context.shadowOffsetY=t.y))),this.context.beginPath(),this.context.moveTo(this.from.x,this.from.y),this.context.lineTo(this.to.x,this.to.y),this.context.stroke()},a.prototype._offRender=function(){this.props.lineWidth&&(this.offContext.lineWidth=this.props.lineWidth),this.offContext.strokeStyle=this.hitColor,this.offContext.beginPath(),this.offContext.moveTo(this.from.x,this.from.y),this.offContext.lineTo(this.to.x,this.to.y),this.offContext.stroke()},a.prototype.getDimension=function(){return new r.Vector2(r.Vector2.Distance(this.transform.controlPoints[0],this.transform.controlPoints[1]),0)},a);function a(t,o,e,s,i){s=n.call(this,t,o instanceof r.Vector2&&e instanceof r.Vector2?s?o.add((e.x-o.x)*s,(e.y-o.y)*s):o.clone():r.Vector2.Zero(),o instanceof r.Vector2&&e instanceof r.Vector2?[o,e]:[])||this;return s._from=o,s._to=e,(s.props=i)||(s.props={}),s.props.color&&"string"!=typeof s.props.color&&(s.props.color.node=s),s}o.Line=i},834:function(t,o,e){var s,i=this&&this.__extends||(s=function(t,o){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}s(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(o,"__esModule",{value:!0}),o.Polygon=void 0;var n,r=e(726),e=e(697),i=(n=e.Node,i(h,n),h.prototype._render=function(){var t;this.props&&(this.props.outlineColor&&(this.context.strokeStyle="string"==typeof this.props.outlineColor?this.props.outlineColor:this.props.outlineColor.create(this.context)),this.props.fillColor&&(this.context.fillStyle="string"==typeof this.props.fillColor?this.props.fillColor:this.props.fillColor.create(this.context)),this.props.outlineWidth&&(this.context.lineWidth=this.props.outlineWidth),this.props.outlineDashSegments&&this.context.setLineDash(this.props.outlineDashSegments),this.props.shadowColor&&(this.context.shadowColor=this.props.shadowColor),this.props.shadowBlur&&(this.context.shadowBlur=this.props.shadowBlur),this.props.shadowOffset&&(this.props.staticShadow?(this.context.shadowOffsetX=this.props.shadowOffset.x,this.context.shadowOffsetY=this.props.shadowOffset.y):(t=this.props.shadowOffset.transform(this.transform.worldTransform).subtract(this.absolutePosition),this.context.shadowOffsetX=t.x,this.context.shadowOffsetY=t.y))),this.context.beginPath(),this.context.moveTo(this.transform.controlPoints[0].x,this.transform.controlPoints[0].y);for(var o=1;o<this.transform.controlPoints.length;o++)this.context.lineTo(this.transform.controlPoints[o].x,this.transform.controlPoints[o].y);this.context.closePath(),this.props.fill&&this.context.fill(),!this.props.outline&&this.props.fill||this.context.stroke()},h.prototype._offRender=function(){this.props.outlineWidth&&(this.offContext.lineWidth=this.props.outlineWidth),this.offContext.strokeStyle=this.hitColor,this.offContext.fillStyle=this.hitColor,this.offContext.beginPath(),this.offContext.moveTo(this.transform.controlPoints[0].x,this.transform.controlPoints[0].y);for(var t=1;t<this.transform.controlPoints.length;t++)this.offContext.lineTo(this.transform.controlPoints[t].x,this.transform.controlPoints[t].y);this.offContext.closePath(),this.props.fill&&this.offContext.fill(),!this.props.outline&&this.props.fill||this.offContext.stroke()},h.prototype.getDimension=function(){var t=r.Vector2.Bounds(this.transform.controlPoints);return new r.Vector2(Math.abs(t[0].x-t[1].x),Math.abs(t[0].y-t[1].y))},h);function h(t,o,e,s){o=n.call(this,t,e instanceof r.Vector2?e:r.Vector2.Average(o),o)||this;return(o.props=s)||(o.props={}),o.props.outlineColor&&"string"!=typeof o.props.outlineColor&&(o.props.outlineColor.node=o),o.props.fillColor&&"string"!=typeof o.props.fillColor&&(o.props.fillColor.node=o),o}o.Polygon=i},265:function(t,o,e){var s,i=this&&this.__extends||(s=function(t,o){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}s(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(o,"__esModule",{value:!0}),o.Rectangle=void 0;var n,r=e(726),e=e(697),i=(n=e.Node,i(h,n),h.prototype._render=function(){var t;this.props&&(this.props.outlineColor&&(this.context.strokeStyle="string"==typeof this.props.outlineColor?this.props.outlineColor:this.props.outlineColor.create(this.context)),this.props.fillColor&&(this.context.fillStyle="string"==typeof this.props.fillColor?this.props.fillColor:this.props.fillColor.create(this.context)),this.props.outlineWidth&&(this.context.lineWidth=this.props.outlineWidth),this.props.outlineDashSegments&&this.context.setLineDash(this.props.outlineDashSegments),this.props.shadowColor&&(this.context.shadowColor=this.props.shadowColor),this.props.shadowBlur&&(this.context.shadowBlur=this.props.shadowBlur),this.props.shadowOffset&&(this.props.staticShadow?(this.context.shadowOffsetX=this.props.shadowOffset.x,this.context.shadowOffsetY=this.props.shadowOffset.y):(t=this.props.shadowOffset.transform(this.transform.worldTransform).subtract(this.absolutePosition),this.context.shadowOffsetX=t.x,this.context.shadowOffsetY=t.y))),this.context.beginPath(),this.context.moveTo(this.transform.controlPoints[0].x,this.transform.controlPoints[0].y),this.context.lineTo(this.transform.controlPoints[1].x,this.transform.controlPoints[1].y),this.context.lineTo(this.transform.controlPoints[2].x,this.transform.controlPoints[2].y),this.context.lineTo(this.transform.controlPoints[3].x,this.transform.controlPoints[3].y),this.context.lineTo(this.transform.controlPoints[0].x,this.transform.controlPoints[0].y),this.props.fill&&this.context.fill(),!this.props.outline&&this.props.fill||this.context.stroke()},h.prototype._offRender=function(){this.props.outlineWidth&&(this.offContext.lineWidth=this.props.outlineWidth),this.offContext.strokeStyle=this.hitColor,this.offContext.fillStyle=this.hitColor,this.offContext.beginPath(),this.offContext.moveTo(this.transform.controlPoints[0].x,this.transform.controlPoints[0].y),this.offContext.lineTo(this.transform.controlPoints[1].x,this.transform.controlPoints[1].y),this.offContext.lineTo(this.transform.controlPoints[2].x,this.transform.controlPoints[2].y),this.offContext.lineTo(this.transform.controlPoints[3].x,this.transform.controlPoints[3].y),this.offContext.lineTo(this.transform.controlPoints[0].x,this.transform.controlPoints[0].y),this.props.fill&&this.offContext.fill(),!this.props.outline&&this.props.fill||this.offContext.stroke()},h.prototype.getDimension=function(){return new r.Vector2(r.Vector2.Distance(this.transform.controlPoints[0],this.transform.controlPoints[1]),r.Vector2.Distance(this.transform.controlPoints[1],this.transform.controlPoints[2]))},h);function h(t,o,e,s,i){s=n.call(this,t,o,[o.add(-e/2,-s/2),o.add(e/2,-s/2),o.add(e/2,s/2),o.add(-e/2,s/2)])||this;return(s.props=i)||(s.props={}),s.props.outlineColor&&"string"!=typeof s.props.outlineColor&&(s.props.outlineColor.node=s),s.props.fillColor&&"string"!=typeof s.props.fillColor&&(s.props.fillColor.node=s),s}o.Rectangle=i},940:function(t,o,e){var s,i=this&&this.__extends||(s=function(t,o){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){function e(){this.constructor=t}s(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(o,"__esModule",{value:!0}),o.Text=void 0;var n,r=e(726),e=e(697),i=(n=e.Node,i(h,n),Object.defineProperty(h.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!1,configurable:!0}),h.prototype._render=function(){var t;this.props&&(this.props.outlineColor&&(this.context.strokeStyle="string"==typeof this.props.outlineColor?this.props.outlineColor:this.props.outlineColor.create(this.context)),this.props.fillColor&&(this.context.fillStyle="string"==typeof this.props.fillColor?this.props.fillColor:this.props.fillColor.create(this.context)),this.props.outlineWidth&&(this.context.lineWidth=this.props.outlineWidth),this.props.shadowColor&&(this.context.shadowColor=this.props.shadowColor),this.props.shadowBlur&&(this.context.shadowBlur=this.props.shadowBlur),this.props.shadowOffset&&(this.props.staticShadow?(this.context.shadowOffsetX=this.props.shadowOffset.x,this.context.shadowOffsetY=this.props.shadowOffset.y):(t=this.props.shadowOffset.transform(this.transform.worldTransform).subtract(this.absolutePosition),this.context.shadowOffsetX=t.x,this.context.shadowOffsetY=t.y)),this.props.font&&(this.context.font=this.props.font)),this.context.translate(this.absolutePosition.x,this.absolutePosition.y),this.context.scale(this.scale.x,this.scale.y),this.context.rotate(this.transform.worldTransform.getRotation()*(Math.PI/180)),this.context.translate(-this.absolutePosition.x,-this.absolutePosition.y),this.props.outline&&this.context.strokeText(this.text,this.absolutePosition.x-this._originalWidth/2,this.absolutePosition.y+this._originalHeight/2),!this.props.fill&&this.props.outline||this.context.fillText(this.text,this.absolutePosition.x-this._originalWidth/2,this.absolutePosition.y+this._originalHeight/2)},h.prototype._offRender=function(){this.offContext.fillStyle=this.hitColor,this.offContext.translate(this.absolutePosition.x,this.absolutePosition.y),this.offContext.scale(this.scale.x,this.scale.y),this.offContext.rotate(this.transform.worldTransform.getRotation()*(Math.PI/180)),this.offContext.translate(-this.absolutePosition.x,-this.absolutePosition.y),this.offContext.fillRect(this.absolutePosition.x-this._originalWidth/2,this.absolutePosition.y-this._originalHeight/2,this._originalWidth,this._originalHeight)},h.prototype.getDimension=function(){return new r.Vector2(r.Vector2.Distance(this.transform.controlPoints[0],this.transform.controlPoints[1]),0)},h);function h(t,o,e,s){o=n.call(this,t,o,[])||this;(o.props=s)||(o.props={}),o.text=e,o.props.outlineColor&&"string"!=typeof o.props.outlineColor&&(o.props.outlineColor.node=o),o.props.fillColor&&"string"!=typeof o.props.fillColor&&(o.props.fillColor.node=o);s=document.createElement("canvas").getContext("2d");return o.props.font&&(s.font=o.props.font),o._originalWidth=s.measureText(e).width,o._originalHeight=s.measureText("M").width,o}o.Text=i},842:function(t,o,e){var s=this&&this.__createBinding||(Object.create?function(t,o,e,s){void 0===s&&(s=e),Object.defineProperty(t,s,{enumerable:!0,get:function(){return o[e]}})}:function(t,o,e,s){t[s=void 0===s?e:s]=o[e]}),i=this&&this.__exportStar||function(t,o){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(o,e)||s(o,t,e)};Object.defineProperty(o,"__esModule",{value:!0}),o.RadialGradient=o.LinearGradient=void 0;var n=e(726),r=e(726),h=e(900);i(e(985),o),i(e(397),o),i(e(700),o),i(e(605),o),i(e(834),o),i(e(265),o),i(e(940),o);a.prototype.create=function(t){var e,s=this,o=new r.Vector2(0,0),i=this.length==h.Handle.AUTO?this.node.getDimension().max():this.length;return o.x=i/2*Math.cos(this.degrees*n.Constant.TAU),o.y=i/2*Math.sin(this.degrees*n.Constant.TAU),i=this.offset.subtract(o).transform(this.node.transform.worldTransform),o=this.offset.add(o).transform(this.node.transform.worldTransform),e=t.createLinearGradient(i.x,i.y,o.x,o.y),this.colors.forEach(function(t,o){e.addColorStop(s.weights[o],t)}),e},e=a;function a(t,o,e,s,i){this.offset=t,this.degrees=o,this.length=e,this.colors=s,this.weights=i}o.LinearGradient=e;l.prototype.create=function(t){var o,e=this,s=this.fromOffset.transform(this.node.transform.worldTransform),i=this.toOffset.transform(this.node.transform.worldTransform),n=this.fromRadius==h.Handle.AUTO||this.toRadius==h.Handle.AUTO?(o=1,this.node.getDimension().max()/2):(o=this.fromRadius,this.toRadius),r=t.createRadialGradient(s.x,s.y,o,i.x,i.y,n);return this.colors.forEach(function(t,o){r.addColorStop(e.weights[o],t)}),r},e=l;function l(t,o,e,s,i,n){this.fromOffset=t,this.fromRadius=o,this.toOffset=e,this.toRadius=s,this.colors=i,this.weights=n}o.RadialGradient=e},235:(t,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Canvas=void 0;var e=(s.prototype.draw=function(t){-1!=this.drawingHandle&&window.cancelAnimationFrame(this.drawingHandle),window.requestAnimationFrame(t.render.bind(t))},s);function s(t,o,e){this.drawingHandle=-1,t?t instanceof HTMLDivElement?(this.canvasElement=document.createElement("canvas"),o&&e?(this.canvasElement.width=o,this.canvasElement.height=e):(this.canvasElement.width=t.clientWidth,this.canvasElement.height=t.clientHeight),t.appendChild(this.canvasElement)):(this.canvasElement=t,o&&e&&(this.canvasElement.width=o,this.canvasElement.height=e)):(this.canvasElement=document.createElement("canvas"),this.canvasElement.width=document.body.clientWidth,this.canvasElement.height=document.body.clientHeight,document.body.appendChild(this.canvasElement)),this.width=this.canvasElement.width,this.height=this.canvasElement.height,this.context=this.canvasElement.getContext("2d"),this.offCanvasElement=new OffscreenCanvas(this.width,this.height),this.offContext=this.offCanvasElement.getContext("2d")}o.Canvas=e},148:(t,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Color=void 0;var e=(s.Random=function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},s.rgbToHex=function(t){return"#"+s._componentToHex(t[0])+s._componentToHex(t[1])+s._componentToHex(t[2])},s._componentToHex=function(t){t=t.toString(16);return 1==t.length?"0"+t:t},s);function s(){}o.Color=e},346:(t,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Debug=void 0;var e=(r.debugPoint=function(t,o,e,s,i){r.limitDebugCalls(o,t,i),o.debugCalls[t].push({debugFunction:r._debugPoint,arguments:[o.canvas.context,e.clone(),s]})},r._debugPoint=function(t,o,e){t.fillStyle=e.color,t.beginPath(),t.arc(o.x,o.y,e.radius||2,0,2*Math.PI),t.fill()},r.debugLine=function(t,o,e,s,i,n){r.limitDebugCalls(o,t,n),o.debugCalls[t].push({debugFunction:r._debugLine,arguments:[o.canvas.context,e.clone(),s.clone(),i]})},r._debugLine=function(t,o,e,s){t.strokeStyle=s.color,t.lineWidth=s.width||1,t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(e.x,e.y),t.stroke(),t.fillStyle="green",t.beginPath(),t.arc(o.x,o.y,2,0,2*Math.PI),t.fill(),t.fillStyle="red",t.beginPath(),t.arc(e.x,e.y,2,0,2*Math.PI),t.fill()},r.show=function(t,o){for(var e in t)for(var s=0,i=t[e];s<i.length;s++){var n=i[s];o.save(),n.debugFunction.apply(n,n.arguments),o.restore()}},r.limitDebugCalls=function(t,o,e){e&&t.debugCalls[o]&&e-1<t.debugCalls[o].length?t.debugCalls[o].shift():t.debugCalls[o]&&e||(t.debugCalls[o]=[])},r);function r(){}o.Debug=e},333:(t,o,e)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Drawing=void 0;var s=e(346),i=e(726),n=e(842),r=e(697),h=e(148),e=(a.prototype._registerEvents=function(){var o,e,s,i=this,n=null;this.canvas.canvasElement.onmousemove=function(t){s=i.canvas.canvasElement.getBoundingClientRect(),i.mousePos.x=t.clientX-s.left,i.mousePos.y=t.clientY-s.top,(o=i._getHitNode(i.mousePos))!=e&&(e&&e.call("mouseexit"),o&&o.call("mouseenter")),e=o,n&&n.call("drag",[i.mousePos.clone()])},this.canvas.canvasElement.onmousedown=function(){n=o;var t=i._getHitNode(i.mousePos);t&&t.call("mousedown")},this.canvas.canvasElement.onmouseup=function(){n=null;var t=i._getHitNode(i.mousePos);t&&t.call("mouseup")},this.canvas.canvasElement.onclick=function(){var t=i._getHitNode(i.mousePos);t&&t.call("click")},this.canvas.canvasElement.oncontextmenu=function(t){t.preventDefault();t=i._getHitNode(i.mousePos);t&&t.call("rightclick")}},a.prototype._getHitNode=function(t){return this.colorToNode[h.Color.rgbToHex(this.canvas.offContext.getImageData(t.x,t.y,1,1).data)]},a.prototype.render=function(){this.canvas.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.offContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderTree.call("update"),this.globalUpdate&&this.globalUpdate(),this.renderTree.transform.childs.forEach(function(t){t.updateWorldTransform()}),this.renderTree.transform.childs.forEach(function(t){t.node.render()}),s.Debug.show(this.debugCalls,this.canvas.context),window.requestAnimationFrame(this.render.bind(this))},a.prototype.add=function(t){var o=this;t instanceof r.Node?(t.parent=this.renderTree,t.setContext(this.canvas.context,this.canvas.offContext),t.setDrawing(this),t.setHitColor()):t.forEach(function(t){t.parent=o.renderTree,t.setContext(o.canvas.context,o.canvas.offContext),t.setDrawing(o),t.setHitColor()})},a.prototype.remove=function(t){t instanceof r.Node&&(t=t.id);var o,e=[];for(e.push(this.renderTree);o=e.shift();)o.id==t?o.transform.parent.childs.splice(o.transform.parent.childs.indexOf(o.transform),1):o.transform.childs.forEach(function(t){e.push(t.node)})},a.prototype._debugSceneGraph=function(t,o){var e=this;console.log(o+t.id+"["+t.order+"]"),t.transform.childs.forEach(function(t){e._debugSceneGraph(t.node," "+o)})},a);function a(t,o){this.canvas=t,this.globalUpdate=o;o=new n.Empty("#Root",i.Vector2.Zero());o.context=this.canvas.context,(o.drawing=this).renderTree=o,this.debugCalls={},this.mousePos=i.Vector2.Zero(),this.colorToNode={},this._registerEvents()}o.Drawing=e},900:(t,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Handle=void 0,(o=o.Handle||(o.Handle={}))[o.AUTO=-1]="AUTO"},697:function(t,o,e){var n=this&&this.__spreadArrays||function(){for(var t=0,o=0,e=arguments.length;o<e;o++)t+=arguments[o].length;for(var s=Array(t),i=0,o=0;o<e;o++)for(var n=arguments[o],r=0,h=n.length;r<h;r++,i++)s[i]=n[r];return s};Object.defineProperty(o,"__esModule",{value:!0}),o.Node=void 0;var s=e(726),i=e(726),r=e(148),e=(Object.defineProperty(h.prototype,"zIndex",{get:function(){return this.order},set:function(t){this.order=t,this.parent&&this.parent.transform.childs.sort(function(t,o){return t.node.order-o.node.order})},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"parent",{get:function(){return this.transform.parent.node},set:function(t){this.transform.parent=t.transform},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"childs",{get:function(){return this.transform.childs.map(function(t){return t.node})},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"absolutePosition",{get:function(){return this.transform.absolutePosition},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"localRotation",{get:function(){return this.transform.localRotation},set:function(t){this.transform.localRotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale=t},enumerable:!1,configurable:!0}),h.prototype.setHitColor=function(){for(var t=r.Color.Random();this.drawing.colorToNode[t];)t=r.Color.Random();this.hitColor=t,(this.drawing.colorToNode[t]=this).transform.childs.forEach(function(t){t.node.setHitColor()})},h.prototype.on=function(t,o){this.registeredEvents[t]=o},h.prototype.render=function(){this.context.save(),this._render(),this.context.restore(),this.offRender();for(var t=0,o=this.transform.childs;t<o.length;t++)o[t].node.render()},h.prototype.offRender=function(){this.offContext.save(),this._offRender(),this.offContext.restore()},h.prototype.call=function(t,o){var e;this.registeredEvents[t]&&(o?(e=this.registeredEvents)[t].apply(e,n([this],o)):this.registeredEvents[t](this));for(var s=0,i=this.transform.childs;s<i.length;s++)i[s].node.call(t,o)},h.prototype.setContext=function(o,e){this.context=o,this.offContext=e,this.transform.childs.forEach(function(t){t.node.setContext(o,e)})},h.prototype.setDrawing=function(o){this.drawing=o,this.transform.childs.forEach(function(t){t.node.setDrawing(o)})},h.prototype.dispose=function(){this.drawing.remove(this.id)},h);function h(t,o,e){this.id=t,this.transform=new s.Transform(o,0,0,i.Vector2.One(),e,this),this.registeredEvents={},this.order=0}o.Node=e},229:function(t,o,e){var s=this&&this.__createBinding||(Object.create?function(t,o,e,s){void 0===s&&(s=e),Object.defineProperty(t,s,{enumerable:!0,get:function(){return o[e]}})}:function(t,o,e,s){t[s=void 0===s?e:s]=o[e]}),i=this&&this.__exportStar||function(t,o){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(o,e)||s(o,t,e)};Object.defineProperty(o,"__esModule",{value:!0}),o.View=void 0,i(e(900),o),i(e(333),o),i(e(346),o),i(e(148),o),i(e(235),o),o.View=e(842),i(e(726),o)}},i={};return function t(o){if(i[o])return i[o].exports;var e=i[o]={exports:{}};return s[o].call(e.exports,e,e.exports,t),e.exports}(229)})()});
//# sourceMappingURL=percept.min.js.map